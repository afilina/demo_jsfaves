<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Javascript Faves</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script type="text/javascript" src="js/jquery-1.5.2.min.js"></script>
<script type="text/javascript" src="js/highcharts.min.js"></script>

<script type="text/javascript" charset="utf-8">
	var data = [
	{"id":"2011-07-15","name":"Jul 15","date":"2011-07-15","y":"31"},
	{"id":"2011-07-17","name":"Jul 17","date":"2011-07-17","y":"4"},
	{"id":"2011-07-18","name":"Jul 18","date":"2011-07-18","y":"3"},
	{"id":"2011-07-19","name":"Jul 19","date":"2011-07-19","y":"40"},
	{"id":"2011-07-20","name":"Jul 20","date":"2011-07-20","y":"17"},
	{"id":"2011-07-21","name":"Jul 21","date":"2011-07-21","y":"6"},
	{"id":"2011-07-22","name":"Jul 22","date":"2011-07-22","y":"8"},
	{"id":"2011-07-23","name":"Jul 23","date":"2011-07-23","y":"7"},
	{"id":"2011-07-24","name":"Jul 24","date":"2011-07-24","y":"11"},
	{"id":"2011-07-25","name":"Jul 25","date":"2011-07-25","y":"7"},
	{"id":"2011-07-26","name":"Jul 26","date":"2011-07-26","y":"17"},
	{"id":"2011-07-27","name":"Jul 27","date":"2011-07-27","y":"7"},
	{"id":"2011-07-28","name":"Jul 28","date":"2011-07-28","y":"2"},
	{"id":"2011-07-29","name":"Jul 29","date":"2011-07-29","y":"2"},
	{"id":"2011-07-31","name":"Jul 31","date":"2011-07-31","y":"4"},
	{"id":"2011-08-01","name":"Aug 01","date":"2011-08-01","y":"2"},
	{"id":"2011-08-02","name":"Aug 02","date":"2011-08-02","y":"19"},
	{"id":"2011-08-03","name":"Aug 03","date":"2011-08-03","y":"2"},
	{"id":"2011-08-04","name":"Aug 04","date":"2011-08-04","y":"2"},
	{"id":"2011-08-05","name":"Aug 05","date":"2011-08-05","y":"3"},
	{"id":"2011-08-06","name":"Aug 06","date":"2011-08-06","y":"4"},
	{"id":"2011-08-07","name":"Aug 07","date":"2011-08-07","y":"1"},
	{"id":"2011-08-08","name":"Aug 08","date":"2011-08-08","y":"9"},
	{"id":"2011-08-09","name":"Aug 09","date":"2011-08-09","y":"3"},
	{"id":"2011-08-10","name":"Aug 10","date":"2011-08-10","y":"6"},
	{"id":"2011-08-11","name":"Aug 11","date":"2011-08-11","y":"3"},
	{"id":"2011-08-12","name":"Aug 12","date":"2011-08-12","y":"4"},
	{"id":"2011-08-15","name":"Aug 15","date":"2011-08-15","y":"8"},
	{"id":"2011-08-16","name":"Aug 16","date":"2011-08-16","y":"4"},
	{"id":"2011-08-17","name":"Aug 17","date":"2011-08-17","y":"4"},
	{"id":"2011-08-18","name":"Aug 18","date":"2011-08-18","y":"1"},
	{"id":"2011-08-19","name":"Aug 19","date":"2011-08-19","y":"1"},
	{"id":"2011-08-21","name":"Aug 21","date":"2011-08-21","y":"6"},
	{"id":"2011-08-22","name":"Aug 22","date":"2011-08-22","y":"4"},
	{"id":"2011-08-23","name":"Aug 23","date":"2011-08-23","y":"4"},
	{"id":"2011-08-24","name":"Aug 24","date":"2011-08-24","y":"25"},
	{"id":"2011-08-25","name":"Aug 25","date":"2011-08-25","y":"7"},
	{"id":"2011-08-26","name":"Aug 26","date":"2011-08-26","y":"4"},
	{"id":"2011-08-27","name":"Aug 27","date":"2011-08-27","y":"3"},
	{"id":"2011-08-28","name":"Aug 28","date":"2011-08-28","y":"1"},
	{"id":"2011-08-29","name":"Aug 29","date":"2011-08-29","y":"10"},
	{"id":"2011-08-30","name":"Aug 30","date":"2011-08-30","y":"9"},
	{"id":"2011-08-31","name":"Aug 31","date":"2011-08-31","y":"18"},
	{"id":"2011-09-01","name":"Sep 01","date":"2011-09-01","y":"12"},
	{"id":"2011-09-02","name":"Sep 02","date":"2011-09-02","y":"8"},
	{"id":"2011-09-03","name":"Sep 03","date":"2011-09-03","y":"2"},
	{"id":"2011-09-04","name":"Sep 04","date":"2011-09-04","y":"1"},
	{"id":"2011-09-05","name":"Sep 05","date":"2011-09-05","y":"3"},
	{"id":"2011-09-06","name":"Sep 06","date":"2011-09-06","y":"3"},
	{"id":"2011-09-07","name":"Sep 07","date":"2011-09-07","y":"6"},
	{"id":"2011-09-08","name":"Sep 08","date":"2011-09-08","y":"5"},
	{"id":"2011-09-09","name":"Sep 09","date":"2011-09-09","y":"7"},
	{"id":"2011-09-10","name":"Sep 10","date":"2011-09-10","y":"1"},
	{"id":"2011-09-11","name":"Sep 11","date":"2011-09-11","y":"6"},
	{"id":"2011-09-12","name":"Sep 12","date":"2011-09-12","y":"3"},
	{"id":"2011-09-13","name":"Sep 13","date":"2011-09-13","y":"8"},
	{"id":"2011-09-14","name":"Sep 14","date":"2011-09-14","y":"17"},
	{"id":"2011-09-15","name":"Sep 15","date":"2011-09-15","y":"16"},
	{"id":"2011-09-16","name":"Sep 16","date":"2011-09-16","y":"87"},
	{"id":"2011-09-17","name":"Sep 17","date":"2011-09-17","y":"4"},
	{"id":"2011-09-18","name":"Sep 18","date":"2011-09-18","y":"1"}
	];
	
	window.cfpChart;
	
	$(function() {
		window.cfpChart = new Highcharts.Chart({
			chart: {
				renderTo: 'cfp-chart',
				marginRight: 130,
				marginBottom: 45,
				height: 230
			},
			title: {
				text: 'Call for Papers',
			},
			xAxis: {
				categories: data,
				labels: {
					y: 25,
					rotation: -45,
					formatter: function() {
						return this.value.name;
					}
				},
				tickInterval: 7
			},
			yAxis: {
				title: {
					text: 'Proposals received'
				}
			},
			tooltip: {
				formatter: function() {
					return '<b>'+ this.point.name +'</b>: '+ this.point.y;
				}
			},
			legend: {
				enabled: false
			},
			plotOptions: {
				line: {
					marker: {
						states: {
							select: {
								radius: 6,
								fillColor: '#da7700'
							}
						}
					}
				}
			},
			series: [{
				id: 'cfp',
				name: 'Papers',
				data: data,
				cursor: 'pointer',
				type: 'line',
				point: {
					events: {
						click: function() {
							loadPiwik(this.date);
						}
					}
				}
			}]
		});
	});
	
	// For the sake of the demo, load a static HTML.
	// In a real scenario, call a script that will get piwik data from an API
	// and generate the chart.
	function loadPiwik(date)
	{
		$('#piwik-page').html('<div style="width:100%;text-align:center;line-height:10em">LOADING...<br />Make sure you open this page using http:// instead of file:// for this part to work.</div>')
		$('#piwik-page').load('piwik.html?date='+date);

		var point = window.cfpChart.get(date);
		if (point) {
			point.select(true, false);
		}
	}
	
</script>

</head>
<body>
	
	<div id="cfp-chart"></div>
	<div id="piwik-page"></div>
	
</body>	
</html>